package de.photon.anticheataddition.modules.sentinel.exploits;

import de.photon.anticheataddition.ServerVersion;
import org.bukkit.potion.PotionEffect;
import org.bukkit.potion.PotionEffectType;

import java.util.Set;

public final class TrollPotionSentinel extends IllegalPotionSentinel
{
    private static final Set<PotionEffectType> ILLEGAL_POTION_TYPES = ServerVersion.containsActive(ServerVersion.MC119.getSupVersionsFrom()) ?
                                                                      Set.of(PotionEffectType.BLINDNESS, PotionEffectType.CONFUSION, PotionEffectType.DARKNESS) :
                                                                      Set.of(PotionEffectType.BLINDNESS, PotionEffectType.CONFUSION);

    public static final TrollPotionSentinel INSTANCE = new TrollPotionSentinel();

    private final int minEffectTime = loadInt(".min_effect_time", 500);

    private TrollPotionSentinel()
    {
        super("Exploits.TrollPotion");
    }

    @Override
    protected boolean isIllegalPotion(PotionEffect effect)
    {
        // Important: Use equals here to check for the PotionEffectType, as that is NOT an Enum!
        return ILLEGAL_POTION_TYPES.contains(effect.getType()) && effect.getDuration() >= minEffectTime;
    }
}
